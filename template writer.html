<!DOCTYPE html>
<html lang="en">

<head>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<title>NeuroTool: Neurointervention Device Sizer</title>
	<link type="text/css" rel="stylesheet" href="css/bootstrap.min.css" />
	<link type="text/css" rel="stylesheet" href="css/bootstrap-vue.css" />
	<link href="css/VueBootstrapTypeahead.css" rel="stylesheet" />
	<link type="text/css" rel="stylesheet" href="css/my.css" />
	<!-- Load polyfills to support older browsers -->
	<script src="js/polyfill.min.js"></script>
	<!-- Required scripts -->
	<script src="js/vue.js"></script>
	<script src="js/bootstrap-vue.js"></script>
	<script src="js/bootstrap-vue-icons.min.js"></script>
	<!-- Type Ahead Library -->
	<script src="js/VueBootstrapTypeahead.umd.min.js"></script>
	<!-- Device Library -->
	<script src="deviceList.js"></script>
	<script src="templateList.js"></script>


</head>

<body>
	<div id="app">

		<b-navbar toggleable="lg" type="dark" variant="info">
			<b-navbar-brand href="#">NeuroTool</b-navbar-brand>

			<b-navbar-toggle target="nav-collapse"></b-navbar-toggle>

			<b-collapse id="nav-collapse" is-nav>
				<b-navbar-nav>
				</b-navbar-nav>

				<b-navbar-nav class="ml-auto">
					<b-nav-item-dropdown right>

						<template #button-content>
							Help
						</template>
						<b-dropdown-item v-b-modal.help_modal>About</b-dropdown-item>
					</b-nav-item-dropdown>
				</b-navbar-nav>
			</b-collapse>
		</b-navbar>

		<b-container>
			<p></p>
			<h2>Template entry: </h2>

			<vue-bootstrap-typeahead :data="templates" :serializer="item => item.name" @hit="selectTemplate($event)">
			</vue-bootstrap-typeahead>
			<p></p>

			<h2>Report text: </h2>

			<template>
				<div>
					<b-form-textarea id="report_input" plaintext :value="reportText" rows="15"></b-form-textarea>
				</div>
			</template>
		</b-container>


		<p></p>
		<p></p>


		<!---------------- MODALS -------------->

		<b-modal id="help_modal" title="NeuroTool: Help" ok-only>
		</b-modal>

		<b-container class="footer">
			This tool is for educational purposes only. <b-link href="mailto: jeremy.lynch@gmail.com"> Contact us.
			</b-link>
		</b-container>

	</div>


	<script>
		/* GENERIC FUNCTIONS */

		function loadXML() {
			var xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function () {
				if (this.readyState == 4 && this.status == 200) {
					myFunction(this);
				}
			};
			xhttp.open("GET", "http://neurotool.org/templates.xml", true);
			xhttp.send();

			var temp = [];

			function myFunction(xml) {
				var xmlDoc = xml.responseXML;
				var templates = xmlDoc.getElementsByTagName("TEMPLATE");
				for (var i = 0; i < templates.length; i++) {
					temp.push({
						name: xmlDoc.getElementsByTagName("TEMPLATE")[i].getElementsByTagName(
							"NAME")[0].innerHTML,
						text: xmlDoc.getElementsByTagName("TEMPLATE")[i].getElementsByTagName(
							"TEXT")[0].innerHTML
					});
				}
			}
			return temp;

		}

		/* GLOBAL VARIABLES */

		window.app = new Vue({
			components: {
				VueBootstrapTypeahead
			},
			el: '#app',
			data: {
				templates: loadXML(),
				reportText: ""
			},

			methods: {
				selectTemplate: function (event) {
					this.reportText = event.text;
				},

				created: function () {

				}
			}
		});


		window.app.created();
	</script>


</body>

</html>