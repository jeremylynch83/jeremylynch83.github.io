<!-- TODO

	* More templates
	* Text substitutions to shorten text
	* Associated info display
	* Copy templates from radReport?

-->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <title>NeuroTool: Predictions</title>
    <link type="text/css" rel="stylesheet" href="css/bootstrap.min.css" />
    <link type="text/css" rel="stylesheet" href="css/bootstrap-vue.css" />
    <link href="css/VueBootstrapTypeahead.css" rel="stylesheet" />
    <link type="text/css" rel="stylesheet" href="css/mytemplate.css" />
    <!-- Load polyfills to support older browsers -->
    <script src="js/polyfill.min.js"></script>
    <!-- Required scripts -->
    <script src="js/vue.js"></script>
    <script src="js/bootstrap-vue.js"></script>
    <script src="js/lodash.js"></script>
    <script src="js/papaparse.js"></script>
    <!-- Type Ahead Library -->
    <script src="js/VueBootstrapTypeahead.umd.min.js"></script>
</head>

<body>
    <div id="app">

        <b-navbar toggleable="lg" type="dark" variant="info">
            <b-navbar-brand href="#">NeuroTool</b-navbar-brand>

            <b-navbar-toggle target="nav-collapse"></b-navbar-toggle>

            <b-collapse id="nav-collapse" is-nav>
                <b-navbar-nav>
                </b-navbar-nav>

                <b-navbar-nav class="ml-auto">
                    <b-nav-item-dropdown right>

                        <template #button-content>
                            Help
                        </template>
                        <b-dropdown-item v-b-modal.help_modal>About</b-dropdown-item>
                    </b-nav-item-dropdown>
                </b-navbar-nav>
            </b-collapse>
        </b-navbar>


        <b-container fluid="sm">
            <p></p>
            <h1>Clinical Prediction Calculators/Classifications</h1>
            <!--<p><i>“The good thing about standards is that there are so many to choose from.” ― Andrew S. Tanenbaum </i>
            </p>-->

            <p></p>
            <template>
                <h2>{{score.title}}</h2>
                <b-form-group label="Select 1 or more classifications:">
                    <b-form-checkbox-group id="checkbox-group-1" v-model="score.selected" :options="score.types">
                    </b-form-checkbox-group>
                </b-form-group>
                </b-form-group>

                <b-card bg-variant="light">
                    <template v-for="n in score.variables">
                        <b-row class="my-1" :key="n.name" v-if="check_score_type(n.score)">

                            <b-col sm="3">
                                <label>{{ n.text }}:</label>
                            </b-col>
                            <b-col sm="9">
                                <b-form-input v-if="n.type == 'text'|| n.type =='number'" :id="`n.name-${n.name}`"
                                    :type="n.type" v-model="n.selected">
                                </b-form-input>

                                <b-form-select v-if="n.type == 'select'" :id="`n.name-${n.name}`" :options="n.options"
                                    v-model="n.selected">
                                </b-form-select>

                                <b-form-radio-group v-if="n.type == 'radio'" :id="`n.name-${n.name}`"
                                    :options="n.options" v-model="n.selected">
                                </b-form-radio-group>
                            </b-col>
                            <!--<b-col sm="2" >
                            <label>{{ n.score }}</label>
                        </b-col>-->
                        </b-row>
                    </template>

                </b-card>

            </template>
            <p></p>
            <p></p>

            <b-button @click="calculate()">Calculate</b-button>
            <p></p>

            <b-card bg-variant="light">

                <div id="result_text" class="calc_result"></div>

            </b-card>


            <!---------------- MODALS -------------->

            <b-modal id=" help_modal" title="NeuroTool: Help" ok-only>
            </b-modal>

            <b-container class="footer">
                This tool is for educational purposes only. <b-link href="mailto: jeremy.lynch@gmail.com"> Contact
                    us.
                </b-link>
            </b-container>

    </div>


    <script>
        /* GENERIC FUNCTIONS */


        function flatten(data) {
            var result = {};

            function recurse(cur, prop) {
                if (Object(cur) !== cur) {
                    result[prop] = cur;
                } else if (Array.isArray(cur)) {
                    for (var i = 0, l = cur.length; i < l; i++)
                        recurse(cur[i], prop + "[" + i + "]");
                    if (l == 0)
                        result[prop] = [];
                } else {
                    var isEmpty = true;
                    for (var p in cur) {
                        isEmpty = false;
                        recurse(cur[p], prop ? prop + "." + p : p);
                    }
                    if (isEmpty && prop)
                        result[prop] = {};
                }
            }
            recurse(data, "");
            return result;
        }

        function get_var(name, array) {

            var match = null;
            for (var n = 0; n < array.length; n++) {
                if (array[n].name == name) match = n;
            }

            return array[match];
        }


        /* PREDICTION TOOLS */

        aneurysm_risk = {
            title: "Incidental aneurysm rupture risk",
            selected: ["PHASES", "ISUIA"],
            types: [{
                    value: "PHASES",
                    text: "PHASES"
                },
                {
                    value: "ISUIA",
                    text: "ISUIA"
                },
                {
                    value: "UIATS",
                    text: "UIATS"
                }
            ],
            variables: [{
                    name: "size",
                    score: "PHASES/ISUIA/UIATS",
                    type: "number",
                    text: "Enter size in mm",
                    selected: null,
                    phases_score: function () {
                        var total = 0;
                        if (this.selected) {
                            if (this.selected < 7) total = 0;
                            if (this.selected >= 7 && this.selected < 10) total = 3;
                            if (this.selected >= 10 && this.selected < 20) total = 6;
                            if (this.selected >= 20) total = 10;
                        }
                        return total;
                    },
                    isuia_score: function () {
                        var total = 0;
                        if (this.selected) {
                            if (this.selected < 7) total = 0;
                            if (this.selected >= 7 && this.selected < 13) total = 1;
                            if (this.selected >= 13 && this.selected < 25) total = 2;
                            if (this.selected >= 25) total = 3;
                        }
                        return total;
                    },
                    uiats_score: function () {
                        var total = 0;
                        if (this.selected) {
                            if (this.selected < 4) total = 0;
                            if (this.selected >= 4 && this.selected < 7) total = 1;
                            if (this.selected >= 7 && this.selected < 13) total = 2;
                            if (this.selected >= 13 && this.selected < 25) total = 3;

                            if (this.selected >= 25) total = 4;
                        }
                        return total;
                    },
                    uiats_score_rx: function () {
                        var total = 0;
                        if (this.selected) {
                            if (this.selected < 6) total = 0;
                            if (this.selected >= 6 && this.selected < 10) total = 1;
                            if (this.selected >= 10 && this.selected < 20) total = 3;
                            if (this.selected >= 20) total = 5;
                        }
                        return total;
                    }
                },
                {
                    name: "site",
                    score: "PHASES/ISUIA/UIATS",
                    type: "select",
                    options: [{
                            value: 'cavernous',
                            text: 'Cavernous ICA'
                        }, {
                            value: 'ica',
                            text: 'Intradural ICA'
                        },
                        {
                            value: 'mca',
                            text: 'MCA'
                        },
                        {
                            value: 'aca',
                            text: 'ACA'
                        },
                        {
                            value: 'acom',
                            text: 'ACom'
                        },
                        {
                            value: 'pca',
                            text: 'PCA'
                        }, {
                            value: 'pcom',
                            text: 'PCOM'
                        },
                        {
                            value: 'va',
                            text: 'Vertebral artery'
                        },
                        {
                            value: 'ba_tip',
                            text: 'Tip of basilar artery'
                        },
                        {
                            value: 'ba',
                            text: 'Rest of basilar artery'
                        }
                    ],
                    text: "Enter site",
                    selected: null,
                    phases_score: function () {
                        var total = 0;
                        if (this.selected) {
                            if (this.selected == "cavernous") total = -1;
                            if (this.selected == "ica") total = 0;
                            if (this.selected == "mca") total = 2;
                            if (this.selected == "pca" || this.selected == "pcom" || this.selected ==
                                "va" || this.selected ==
                                "ba_tip" || this
                                .selected == "ba" || this.selected == "aca" || this
                                .selected == "acom") total = 4;
                        }
                        return total;
                    },
                    isuia_score: function () {
                        var total = 0;
                        if (this.selected) {
                            if (this.selected == "cavernous") total = 0;
                            if (this.selected == "mca" || this.selected == "aca" || this
                                .selected == "acom" || this
                                .selected == "ica") total = 1;
                            if (this.selected == "pca" || this.selected == "pcom" || this.selected ==
                                "va" || this
                                .selected == "ba" || this
                                .selected == "ba_tip") total = 2;
                        }
                        return total;
                    },
                    uiats_score: function () {
                        var total = 0;
                        if (this.selected) {
                            if (this.selected == "cavernous") total = 0;
                            if (this.selected == "bas_tip") total = 5;
                            if (this.selected == "va" || this.selected == "ba") total = 4;
                            if (this.selected == "acom" || this.selected == "pcom") total = 2;
                        }
                        return total;
                    }
                },
                {
                    name: "ethnicity",
                    score: "PHASES/UIATS",
                    type: "select",
                    options: [{
                            value: 'american',
                            text: 'North American/European (except Finnish)'
                        },
                        {
                            value: 'japanese',
                            text: 'Japanese'
                        },
                        {
                            value: 'finnish',
                            text: 'Finnish'
                        },

                        {
                            value: 'inuit',
                            text: 'Inuit'
                        },
                        {
                            value: 'other',
                            text: 'Other'
                        }
                    ],
                    text: "Enter ethnicity",
                    selected: null,
                    phases_score: function () {
                        var total = 0;
                        if (this.selected) {
                            if (this.selected == "japanese") total = 3;
                            if (this.selected == "finnish") total = 5;
                        }
                        return total;
                    },
                    uiats_score: function () {
                        var total = 0;
                        if (this.selected) {
                            if (this.selected == "japanese" || this.selected == "finnish" || this
                                .selected == "inuit") total = 2;
                        }
                        return total;
                    }
                },
                {
                    name: "hypertension",
                    score: "PHASES/UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Does the patient have hypertension?",
                    selected: null,
                    phases_score: function () {
                        return this.selected;
                    },
                    uiats_score: function () {
                        return this.selected;
                    }
                },
                {
                    name: "Age",
                    score: "PHASES/UIATS",
                    type: "number",
                    text: "Enter age in years",
                    selected: null,
                    phases_score: function () {
                        var total = 0;
                        if (this.selected && this.selected > 70) {
                            total = 1;
                        }
                        return total;

                    },
                    uiats_score: function () {
                        // This appears twice in the score
                        var total = 0;
                        if (this.selected) {
                            if (this.selected < 40)
                                total = 4;
                            if (this.selected >= 40 && this.selected < 60)
                                total = 3;
                            if (this.selected >= 60 && this.selected < 70)
                                total = 2;
                            if (this.selected >= 70 && this.selected < 80)
                                total = 1;
                            if (this.selected >= 80)
                                total = 0;
                        }
                        return total;
                    },
                    uiats_score_rx: function () {
                        // This appears twice in the score
                        var total = 0;
                        if (this.selected) {
                            if (this.selected < 40)
                                total = 0;
                            if (this.selected >= 40 && this.selected < 60)
                                total = 1;
                            if (this.selected >= 60 && this.selected < 70)
                                total = 3;
                            if (this.selected >= 70 && this.selected < 80)
                                total = 4;
                            if (this.selected >= 80)
                                total = 5;
                        }
                        return total;

                    }
                },
                {
                    name: "other_sah",
                    score: "PHASES/ISUIA/UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Has the patient ever had subarachnoid haemorrhage from another aneurysm?",
                    selected: null,
                    phases_score: function () {
                        return this.selected;
                    },
                    uiats_score: function () {
                        var total = 0;
                        if (this.selected) total = 4;
                        return total;
                    }
                },
                {
                    name: "size_ratio",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Size ratio > 3 or aspects > 1.6?",
                    selected: null,
                    uiats_score: function () {
                        return this.selected;
                    }
                },
                {
                    name: "morphology",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Morphology: irregularity/lobulation?",
                    selected: null,
                    uiats_score: function () {
                        var total = 0;
                        if (this.selected) total = 3
                        return this.selected;
                    }
                },
                {
                    name: "familial",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Familial intracranial aneurysms or SAH?",
                    selected: null,
                    uiats_score: function () {
                        var total = 0;
                        if (this.selected) total = 3;
                        return total;
                    }
                },
                {
                    name: "smoking",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Current cigarette smoking?",
                    selected: null,
                    uiats_score: function () {
                        var total = 0
                        if (this.selected) total = 3;
                        return total;
                    }
                },
                {
                    name: "polycystic",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "ADPKD?",
                    selected: null,
                    uiats_score: function () {
                        var total = 0;
                        if (this.selected) total = 2
                        return this.selected;
                    }
                },
                {
                    name: "drugs",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Current drug abuse (cocaine, amphetamine)?",
                    selected: null,
                    uiats_score: function () {
                        var total = 0;
                        if (this.selected) total = 2
                        return this.selected;
                    }
                },
                {
                    name: "alcohol",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Current alcohol abuse?",
                    selected: null,
                    uiats_score: function () {
                        return this.selected;
                    }
                },
                {
                    name: "cn",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Cranial nerve deficit?",
                    selected: null,
                    uiats_score: function () {
                        var total = 0;
                        if (this.selected) total = 4
                        return this.selected;
                    }
                },
                {
                    name: "mass_Effect",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Clinical/radiological mass effect?",
                    selected: null,
                    uiats_score: function () {
                        var total = 0;
                        if (this.selected) total = 4
                        return this.selected;
                    }
                },
                {
                    name: "thromboembolic",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Thromboembolic events?",
                    selected: null,
                    uiats_score: function () {
                        var total = 0;
                        if (this.selected) total = 3
                        return this.selected;
                    }
                },
                {
                    name: "seizures",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Seizures?",
                    selected: null,
                    uiats_score: function () {
                        return this.selected;
                    }
                },
                {
                    name: "qol",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Reduced quality of life due to fear of rupture?",
                    selected: null,
                    uiats_score: function () {
                        var total = 0;
                        if (this.selected) total = 2;
                        return this.selected;
                    }
                },
                {
                    name: "multiplicity",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Aneurysm multiplicity?",
                    selected: null,
                    uiats_score: function () {
                        return this.selected;
                    }
                },
                {
                    name: "life_expectancy",
                    score: "UIATS",
                    type: "select",
                    options: [{
                            value: 'less than 5 years',
                            text: 'less than 5 years'
                        },
                        {
                            value: '5-10 years',
                            text: '5-10 years'
                        },
                        {
                            value: 'over 10 years',
                            text: 'over 10 years'
                        },
                        {
                            value: 'no_limit',
                            text: 'Not limited'
                        }
                    ],
                    text: "Life expectancy due to chronic and/or malignant disease",
                    selected: null,
                    uiats_score: function () {
                        var total = 0;
                        if (this.selected) {
                            if (this.selected == "less than 5 years" || this.selected == "other")
                                total = 0;
                            if (this.selected == "5-10 years") total = 3;
                            if (this.selected == "over 10 years") total = 5;
                            if (this.selected == "Not limited") total = 5;
                        }
                        return total;
                    }
                },
                {
                    name: "neurodegenerative",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Comorbid neurocognitive disorder?",
                    selected: null,
                    uiats_score: function () {
                        var total = 0;
                        if (this.selected) total = 3
                        return this.selected;
                    }
                },
                {
                    name: "coagulopathy",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Comoborbid coagulopathy or thrombophilia?",
                    selected: null,
                    uiats_score: function () {
                        var total = 0;
                        if (this.selected) total = 2
                        return this.selected;
                    }
                },
                {
                    name: "psych",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Psychiatric disorder?",
                    selected: null,
                    uiats_score: function () {
                        var total = 0;
                        if (this.selected) total = 2
                        return this.selected;
                    }
                },
                {
                    name: "an_growth",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Aneurysm growth on serial imaging?",
                    selected: null,
                    uiats_score: function () {
                        var total = 0;
                        if (this.selected) total = 4
                        return this.selected;
                    }
                },
                {
                    name: "denovo",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "De novo aneurysm formation?",
                    selected: null,
                    uiats_score: function () {
                        var total = 0;
                        if (this.selected) total = 3
                        return this.selected;
                    }
                },
                {
                    name: "stenosis",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'yes'
                    }, {
                        value: 0,
                        text: 'no'
                    }],
                    type: "radio",
                    text: "Contralateral steno-occlusive vessel disease?",
                    selected: null,
                    uiats_score: function () {
                        return this.selected;
                    }
                },
                {
                    name: "treatment_risk",
                    score: "UIATS",
                    options: [{
                        value: 1,
                        text: 'High'
                    }, {
                        value: 0,
                        text: 'Low'
                    }],
                    type: "radio",
                    text: "Aneurysm complexity-relatex risk",
                    selected: null,
                    uiats_score: function () {
                        return this.selected;
                    }
                }

            ],


            calculate: function () {
                var text = "";

                /////////
                // PHASES
                /////////
                const phases_table = {
                    0: "0.4\% (0.1-1.5\%)",
                    1: "0.4\% (0.1-1.5\%)",
                    2: "0.4\% (0.1-1.5\%)",
                    3: "0.7\% (0.2-1.5\%)",
                    4: "0.9\% (0.3-2.0\%)",
                    5: "1.3\% (0.8-2.4\%)",
                    6: "1.7\% (1.1-2.7\%)",
                    7: "2.4\% (1.6-3.3\%)",
                    8: "3.2\% (2.3-4.4\%)",
                    9: "4.3\% (2.9-6.1\%)",
                    10: "5.3\% (3.5-8.0\%)",
                    11: "7.2\% (5.0-10.2\%)",
                }
                var total = 0;
                for (var n = 0; n < this.variables.length; n++) {
                    if (this.variables[n].score.includes("PHASES")) {
                        total = total + this.variables[n].phases_score();
                    }
                }
                var risk = null;

                if (get_var("site", this.variables).phases_score() != -1 && this.selected.includes("PHASES")) {
                    if (total >= 12) risk = "17·8\% (15·2–20·7\%)";
                    else risk = phases_table[total];
                    text = "<p>PHASES: " + risk + " 5-year risk. </p>";
                } else {
                    text = "";

                }

                /////////
                // ISUIA
                /////////
                total = 0;
                risk = null;
                // Size 7mm
                if (get_var("other_sah", this.variables).selected && get_var("size", this.variables)
                    .isuia_score() ==
                    0) {
                    // Previously ruptured and < 7 mm
                    if (get_var("site", this.variables).isuia_score() == 0) {
                        risk = "0\% "
                    } else if (get_var("site", this.variables).isuia_score() == 1) {
                        risk = "1.5\% "
                    } else if (get_var("site", this.variables).isuia_score() == 2) {
                        risk = "3.4\% "
                    }
                } else if (!get_var("other_sah", this.variables).selected && get_var("size", this.variables)
                    .isuia_score() == 0) {
                    // Not previously ruptured and < 7 mm
                    if (get_var("site", this.variables).isuia_score() == 2) {
                        risk = "2.5\% "
                    } else {
                        risk = "0\%";
                    }
                }

                if (get_var("size", this.variables).isuia_score() > 0) {
                    const isuia_table = [
                        [0, "0\%", "3\%", "6.4\%"],
                        [0, "2.6\%", "14.6\%", "40\%"],
                        [0, "18.4\%", "18.4\%", "50\%"]
                    ];
                    // [row][column]
                    var risk = isuia_table[get_var("site", this.variables).isuia_score()][get_var("size",
                            this
                            .variables)
                        .isuia_score()
                    ];
                }
                if (this.selected.includes("ISUIA")) {
                    text = text + "<p>ISUIA: " + risk + " 5-year risk.</p>";
                }

                /////////
                // UIATS
                /////////
                var repair = 0;
                var conserv = 0;
                repair = get_var("Age", this.variables)
                    .uiats_score() + get_var("other_sah", this.variables)
                    .uiats_score() + get_var("familial", this.variables)
                    .uiats_score() + get_var("site", this.variables)
                    .uiats_score() + get_var("smoking", this.variables)
                    .uiats_score() + get_var("polycystic", this.variables)
                    .uiats_score() + get_var("hypertension", this.variables)
                    .uiats_score() + get_var("drugs", this.variables)
                    .uiats_score() + get_var("alcohol", this.variables)
                    .uiats_score() + get_var("cn", this.variables)
                    .uiats_score() + get_var("thromboembolic", this.variables)
                    .uiats_score() + get_var("seizures", this.variables)
                    .uiats_score() + +get_var("qol", this.variables)
                    .uiats_score() + get_var("multiplicity", this.variables)
                    .uiats_score() + get_var("size", this.variables)
                    .uiats_score() + get_var("morphology", this.variables)
                    .uiats_score() + get_var("size_ratio", this.variables)
                    .uiats_score() + get_var("site", this.variables)
                    .uiats_score() + get_var("an_growth", this.variables)
                    .uiats_score() + get_var("denovo", this.variables)
                    .uiats_score() + get_var("stenosis", this.variables)
                    .uiats_score();

                conserv = get_var("life_expectancy", this.variables)
                    .uiats_score() + get_var("neurodegenerative", this.variables)
                    .uiats_score() + get_var("coagulopathy", this.variables)
                    .uiats_score() + get_var("psych", this.variables)
                    .uiats_score() + get_var("Age", this.variables)
                    .uiats_score_rx() + get_var("treatment_risk", this.variables)
                    .uiats_score() + get_var("size", this.variables)
                    .uiats_score_rx() + 5;
                if (this.selected.includes("UIATS")) {
                    text = text + "<p>UIATS: In favour of repair: " + repair +
                        " vs in favour of conservative: " +
                        conserv + "</p>";
                }


                return text;
            }
        }


        /* GLOBAL VARIABLES */

        window.app = new Vue({
            components: {
                VueBootstrapTypeahead
            },
            el: '#app',
            data: {
                id_count: 0,
                score: aneurysm_risk,

                copyModal: {
                    id: 'copy-modal',
                    text: "",
                    title: "Copy"
                }
            },

            methods: {
                // General functions
                calculate: function () {
                    document.getElementById("result_text").innerHTML = this.score.calculate();
                },
                check_score_type: function (str) {
                    var list = str.split("/");
                    var contains = null;
                    for (var n = 0; n < list.length; n++) {
                        if (this.score.selected.includes(list[n])) {
                            contains = true;
                        }
                    }

                    return contains;
                }


            }
        });
    </script>


</body>

</html>